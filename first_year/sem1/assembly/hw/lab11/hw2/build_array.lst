     1                                  bits 32                         
     2                                  segment code use32 public code
     3                                  global build_array
     4                                  
     5                                  extern printf
     6                                  import printf msvcrt.dll
     7                                  
     8                                  segment data use32 class=data
     9 00000000 41727261793A20              array db "Array: "
    10 00000007 25642C2000                  format db "%d, ", 0
    11 0000000C 0000<rept>                  new_arr times 100 dw 0
    12 000000D4 00                          copy db 0
    13                                  
    14                                  build_array:
    15 000000D5 8B4C2408                    mov ecx, [esp + 8]
    16 000000D9 8B742404                    mov esi, [esp + 4]
    17 000000DD B302                        mov bl, 2
    18 000000DF BF[0C000000]                mov edi, new_arr
    19 000000E4 01CE                        add esi, ecx
    20 000000E6 83EE01                      sub esi, 1
    21                                      
    22 000000E9 FD                          std
    23                                      loop1:
    24 000000EA AC                              lodsb
    25 000000EB 2C30                            sub al, '0'
    26 000000ED F6E3                            mul bl
    27 000000EF FC                              cld
    28 000000F0 66AB                            stosw   
    29 000000F2 FD                              std
    30 000000F3 E2F5                        loop loop1
    31                                          
    32 000000F5 8B4C2408                    mov ecx, [esp + 8]
    33 000000F9 BE[0C000000]                mov esi, new_arr
    34 000000FE 83E901                      sub ecx, 1
    35 00000101 FC                          cld
    36                                      loop2:
    37 00000102 890D[D4000000]                  mov [copy], ecx
    38 00000108 66AD                            lodsw
    39 0000010A 31D2                            xor edx, edx
    40 0000010C 6689C2                          mov dx, ax
    41 0000010F 52                              push dword edx
    42 00000110 68[07000000]                    push format
    43 00000115 FF15[00000000]                  call [printf]
    44 0000011B 83C408                          add esp, 8
    45 0000011E 8B0D[D4000000]                  mov ecx, [copy]
    46 00000124 E2DC                        loop loop2
    47                                      
    48 00000126 C3                          ret 
